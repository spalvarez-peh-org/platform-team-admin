#!/bin/bash

# Define the allowed tag format regex (Semantic Versioning)
TAG_REGEX="^v[0-9]+\.[0-9]+\.[0-9]+$"

while read local_ref local_sha remote_ref remote_sha; do
  if [[ "$local_ref" =~ ^refs/tags/ ]]; then
    TAG_NAME="${local_ref##refs/tags/}"

    if ! [[ "$TAG_NAME" =~ $TAG_REGEX ]]; then
      echo "Tag '$TAG_NAME' does not match required format: vX.Y.Z"
      exit 1
    fi
  fi
done
